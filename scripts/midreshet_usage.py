
# -*- coding: utf-8 -*-
import django
django.setup()
from sefaria.model import *
from sefaria.sheets import sheet_list

# Generate a new column for https://docs.google.com/spreadsheets/d/1Fi_Ls70MTxVsr00OFRWlt_yc3X2bMypq0v94mC_AMyw/edit?gid=0#gid=0
# note that there are rows in that sheet that are not inluded here.  They are rows for which there is no Sefaria sheet.  In the past, these needed to be accounted for manually.
# Going forward, perhaps it makes sense to remove those rows, or place them at the bottom of the sheet.

sheet_id_list_for_resource = [
["217838"],
["216682"],
["216636"],
["217484"],
["217090"],
["216478"],
["217925"],
["216340"],
["217154"],
["216110"],
["216630"],
["216797","216555"],
["217842","216083"],
["216188"],
["216679"],
["216088"],
["216215"],
["216327"],
["217587"],
["217828"],
["217187"],
["217597"],
["216531"],
["216646"],
["217229"],
["217213"],
["216769"],
["217618"],
["216830"],
["217366","216270","217034"],
["217154"],
["217611","217240","216159"],
["217296"],
["217426"],
["216338"],
["216466"],
["216364"],
["216710"],
["216670"],
["217300"],
["216263"],
["216340"],
["217366"],
["216349"],
["217454"],
["217411"],
["216150"],
["217140"],
["216368"],
["216264"],
["216526"],
["217909","217581"],
["216090"],
["217820"],
["217195"],
["217701"],
["216565"],
["217239"],
["217259"],
["216530"],
["217953","217757","217220"],
["217546","217434"],
["216621"],
["217296"],
["216385"],
["217292"],
["217896"],
["217740"],
["217617","217408"],
["216124","216913","216164","216891"],
["217587"],
["217539"],
["217898"],
["217625"],
["217646"],
["216953"],
["216625"],
["217341"],
["217656"],
["217877","217248"],
["216211","216073","217596","217731"],
["216200"],
["217110"],
["216805"],
["216539"],
["217317"],
["217053"],
["216772"],
["217690"],
["217717"],
["216572","216102"],
["217782"],
["216421"],
["216784"],
["217853"],
["216490"],
["216526"],
["216553"],
["216960"],
["216769"],
["217717"],
["216340"],
["217603"],
["216846"],
["216438"],
["216110"],
["217599"],
["216523"],
["217565"],
["217082"],
["217228"],
["216850"],
["217962"],
["216124","217395"],
["216492"],
["217734"],
["217863"],
["217844"],
["217844"],
["216385"],
["216772"],
["217021"],
["216521"],
["217932"],
["216960"],
["217379"],
["216420"],
["216597","216380","217395","217684"],
["216586"],
["217740"],
["216110"],
["217229"],
["216233","216421","216724","216769"],
["217838","216243"],
["216826"],
["217889"],
["217792"],
["216582"],
["217140","216784"],
["217339"],
["217261"],
["217792"],
["217654"],
["217962"],
["217346"],
["217740"],
["217556"],
["217153"],
["217870"],
["217873"],
["217239"],
["216111"],
["217646"],
["217229"],
["217154","216121"],
["217734"],
["217074"],
["217802"],
["217219"],
["217845","216215"],
["217905"],
["216763"],
["217317"],
["217107"],
["217675"],
["217896"],
["216162","216986","216458"],
["217516"],
["216200"],
["216784"],
["217639","217143"],
["217880","217188"],
["216067"],
["217723"],
["216340"],
["216338"],
["217676"],
["217317"],
["216564","217100"],
["216671"],
["216537"],
["216486"],
["216986"],
["217366"],
["217740"],
["217804","216806"],
["217619"],
["217140"],
["217617"],
["217617"],
["216706","217768","217799"],
["217431"],
["216960"],
["216642"],
["217811","216335"],
["216358"],
["216358"],
["216341"],
["216164"],
["216164"],
["217443"],
["217424","217015"],
["216579","216102"],
["216579"],
["216579"],
["216570"],
["216668"],
["216494"],
["216475"],
["216475"],
["216475"],
["216780"],
["216849"],
["216823"],
["216813"],
["216668"],
["217846"],
["217809"],
["217809"],
["216087"],
["216087"],
["216070"],
["217471"],
["217818"],
["217498"],
["217360"],
["217360"],
["216753","217613"],
["216696"],
["217033"],
["216261"],
["217262"],
["217395"],
["217395"],
["217558"],
["217672"],
["217395"],
["217305"],
["216099"],
["217209"],
["216099"],
["217747"],
["217731"],
["216404"],
["216239"],
["216274"],
["216470"],
["216644"],
["217055"],
["216049"],
["216629"],
["216589"],
["216580"],
["216601"],
["217216"],
["217497"],
["216610"],
["216591"],
["216659"],
["216865"],
["217200"],
["217200"],
["217200"],
["217383"],
["217130","217015"],
["217504"],
["217504"],
["216588"],
["216650"],
["216650"],
["216571"],
["216707"],
["216956"],
["216905"],
["217093"],
["217162"],
["217141"],
["217141"],
["217284"],
["217284"],
["217251"],
["217404"],
["217404"],
["217351"],
["217351"],
["217526"],
["216122"],
["216122"],
["217568"],
["216163"],
["216536"],
["216536"],
["216674"],
["216694"],
["216694"],
["216694"],
["216825"],
["216825"],
["217975","216749"],
["217035"],
["217035"],
["216928"],
["217258"],
["217258"],
["217226"],
["216232"],
["217424","217015"],
["217730","216515","217015"],
["217130","217015"],
["217496"],
["217496"],
["217384"],
["216266"],
["216652"],
["216652"],
["216936"],
["216898"],
["216677"],
["217269"],
["217269"],
["217297"],
["216707"],
["216117"],
["217970"],
["217632"],
["217388"],
["216714"],
["217908","217830","216102","217210"],
["216822"],
["216822","216846","217276"],
["216994","217621"],
["217975","216749"],
["217983","217027"],
["217973","217020"],
["216691"],
["216778"],
["216812"],
["217998"],
["217949","216807"],
["217958"],
["216213"],
["216978","216789","217835","216723"],
["216940"],
["217632","217122"],
["217935","217133","217507","217576","216208"],
["216858","216456","217088"],
["217486"],
["216080"],
["216250"],
["216198"],
["216445","217669"],
["217904","216556"],
["217312"],
["217215"],
["217388"],
["216840","217429","217942","217133","217220"],
["217263","217276"],
["217263","216727"],
["217563"],
["216216"],
["216770"],
["217956","217888"],
["216535","217860","217808","216106","217879","217070","217923","216818","217613"],
["217312"],
["217777"],
["216286"],
["216394"],
["217823"],
["216498"],
["217693"],
["217959"],
["217275"],
["217607"],
["217993"],
["217117","216241"],
["216141"],
["217773"],
["216496","217559"],
["216496","217559"],
["216778"],
["216042","216725"],
["217147","217426"],
["217388"],
["217949"],
["217959","217151"],
["217673"],
["217295"],
["217904"],
["216697"],
["217147"],
["218004"],
["217403","217070","216946"],
["217312"],
["217992"],
["216182","217108"],
["216929","217487"],
["216329","216448","217846"],
["217275"],
["217964","216494"]
]

view_list = []
for sheet_id_list in sheet_id_list_for_resource:
    sheet_nums = [int(x) for x in sheet_id_list]
    total_views = 0
    slist = sheet_list({"id": {"$in": sheet_nums}})
    total_views = sum([s.get("views",0) for s in slist])
    view_list.append(total_views)

print(total_views)


exit()
